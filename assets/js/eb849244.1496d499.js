"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[310],{2836:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var i=t(5893),s=t(1151);const r={id:"usage",title:"Usage",sidebar_position:3},a=void 0,d={id:"Getting Started/usage",title:"Usage",description:"Initialization",source:"@site/docs/Getting Started/usage.md",sourceDirName:"Getting Started",slug:"/Getting Started/usage",permalink:"/sheets-translate-to-json/docs/Getting Started/usage",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"usage",title:"Usage",sidebar_position:3},sidebar:"GettingStarted",previous:{title:"Sheets",permalink:"/sheets-translate-to-json/docs/Getting Started/sheets"},next:{title:"Example File in Repository",permalink:"/sheets-translate-to-json/docs/Getting Started/exemple"}},c={},l=[{value:"Initialization",id:"initialization",level:2},{value:"Import esm &amp; commonJs",id:"import-esm--commonjs",level:3},{value:"Constructor",id:"constructor",level:3},{value:"Methods",id:"methods",level:2},{value:"init",id:"init",level:3},{value:"read (async)",id:"read-async",level:3},{value:"write (async)",id:"write-async",level:3},{value:"Examples of Using SheetManager",id:"examples-of-using-sheetmanager",level:2},{value:"Using the <code>init</code> Method",id:"using-the-init-method",level:3},{value:"Separately Using the <code>read</code> and <code>write</code> Methods",id:"separately-using-the-read-and-write-methods",level:3},{value:"Running Your Script in JavaScript",id:"running-your-script-in-javascript",level:3},{value:"Running Your Script in TypeScript",id:"running-your-script-in-typescript",level:3},{value:"Result of Executing the SheetManager Script",id:"result-of-executing-the-sheetmanager-script",level:3}];function o(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"initialization",children:"Initialization"}),"\n",(0,i.jsxs)(n.p,{children:["To start using ",(0,i.jsx)(n.code,{children:"sheets-translate-to-json"}),", you first need to create an instance of the ",(0,i.jsx)(n.code,{children:"SheetManager"})," class."]}),"\n",(0,i.jsx)(n.h3,{id:"import-esm--commonjs",children:"Import esm & commonJs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"//CommonJs\nconst {SheetManager} = require('sheets-translate-to-json');\n"})}),"\n",(0,i.jsx)(n.p,{children:"or"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"//ES6(ESM)\nimport { SheetManager } from 'sheets-translate-to-json';\n"})}),"\n",(0,i.jsx)(n.h3,{id:"constructor",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const manager = new SheetManager(privateKey, clientEmail, sheetId);\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"privateKey"}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"The private key of your service account."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"clientEmail"}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"The email associated with your service account."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"sheetId"}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"The ID of your Google Sheets sheet."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(n.h3,{id:"init",children:"init"}),"\n",(0,i.jsx)(n.p,{children:"Initializes the connection to the spreadsheet and writes data to a specified path."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"manager.init(directory);\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"directory"}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"The path of the folder where to write data."})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"read-async",children:"read (async)"}),"\n",(0,i.jsx)(n.p,{children:"Reads data from the specified spreadsheet."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"manager.read(sheetPosition).then(data => {\n  // Use the data here\n});\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"sheetPosition"}),(0,i.jsx)(n.td,{children:"Number"}),(0,i.jsx)(n.td,{children:"The position of the sheet in the workbook (0-index)."})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"write-async",children:"write (async)"}),"\n",(0,i.jsx)(n.p,{children:"Writes data to a JSON file in the specified path."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"manager.write(data, directory);\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"data"}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsx)(n.td,{children:"The data to write."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"directory"}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"The path of the folder where to write JSON files."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"examples-of-using-sheetmanager",children:"Examples of Using SheetManager"}),"\n",(0,i.jsxs)(n.h3,{id:"using-the-init-method",children:["Using the ",(0,i.jsx)(n.code,{children:"init"})," Method"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"init"})," method of ",(0,i.jsx)(n.code,{children:"SheetManager"})," automates the process of reading data from the Google Sheets spreadsheet and writing this data into JSON files."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const manager = new SheetManager(privateKey, clientEmail, sheetId);\n\n// Path where JSON files will be saved\nconst directory = './translations';\n\n// Initialization and automatic processing\nmanager.init(directory)\n  .then(() => console.log('Data successfully read and written.'))\n  .catch(err => console.error('Error during initialization:', err));\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, ",(0,i.jsx)(n.code,{children:"init"})," takes care of the entire process: it establishes the connection, reads the data from the specified spreadsheet, and writes this data to the ",(0,i.jsx)(n.code,{children:"./translations"})," directory."]}),"\n",(0,i.jsxs)(n.h3,{id:"separately-using-the-read-and-write-methods",children:["Separately Using the ",(0,i.jsx)(n.code,{children:"read"})," and ",(0,i.jsx)(n.code,{children:"write"})," Methods"]}),"\n",(0,i.jsxs)(n.p,{children:["If you prefer more control over the process, you can use the ",(0,i.jsx)(n.code,{children:"read"})," and ",(0,i.jsx)(n.code,{children:"write"})," methods separately. This allows you to manipulate the data between reading and writing if necessary."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const manager = new SheetManager(privateKey, clientEmail, sheetId);\n\n// Reading data from the first spreadsheet\nmanager.read()\n  .then(data => {\n    console.log('Data successfully read.');\n    // Data processing or manipulation here if needed\n\n    // Path where JSON files will be saved\n    const directory = './translations';\n    // Writing data into JSON files\n    manager.write(data, directory);\n    console.log('Data written into JSON files.');\n  })\n  .catch(err => console.error('Error during reading:', err));\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this scenario, ",(0,i.jsx)(n.code,{children:"read"})," is used to retrieve the data from the spreadsheet, and after any potential data processing, ",(0,i.jsx)(n.code,{children:"write"})," is used to write this data into local JSON files."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"running-your-script-in-javascript",children:"Running Your Script in JavaScript"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Using Node.js:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Make sure Node.js is installed on your machine. You can check this by running ",(0,i.jsx)(n.code,{children:"node -v"})," in the terminal, which should display the version of Node.js."]}),"\n",(0,i.jsxs)(n.li,{children:["To execute your JavaScript script, use the ",(0,i.jsx)(n.code,{children:"node"})," command followed by the name of your file. For example:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"node your_file_name.js\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This command will execute the JavaScript script using the Node.js environment."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"running-your-script-in-typescript",children:"Running Your Script in TypeScript"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Using TS-Node:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"TS-Node is a TypeScript executor for Node.js. It allows you to run TypeScript scripts directly without needing to transpile them into JavaScript first."}),"\n",(0,i.jsx)(n.li,{children:"If you don't have TS-Node installed yet, you can install it globally via NPM:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install -g ts-node\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Once TS-Node is installed, you can directly execute your TypeScript script. Use the ",(0,i.jsx)(n.code,{children:"ts-node"})," command followed by the name of your file. For example:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ts-node your_file_name.ts\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'This command will execute the TypeScript script by transpiling it "on the fly" into JavaScript and then running it in the Node.js environment.'}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"result-of-executing-the-sheetmanager-script",children:"Result of Executing the SheetManager Script"}),"\n",(0,i.jsxs)(n.p,{children:["After running the ",(0,i.jsx)(n.code,{children:"SheetManager"})," script, the following folder is created with the generated JSON files:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Folder with JSON files",src:t(6508).Z+"",width:"270",height:"127"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"exemple translate json ",src:t(8860).Z+"",width:"400",height:"293"})}),"\n",(0,i.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8860:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/exemple-translate-json-941898a3c21eb4b6ba98246382f41416.png"},6508:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/result-translations-84b0b10bb389f896d96e3daab3fdddd4.png"},1151:(e,n,t)=>{t.d(n,{Z:()=>d,a:()=>a});var i=t(7294);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);